**L9 action2：设计一个基于DNN模型的推荐系统**

*要求：阐述两阶段的架构（召回、排序）以及每个阶段的DNN模型设计：*

1. *DNN输入层（如何进行特征选择）*

2. *DNN隐藏层结构*

3. *DNN输出层*

**目标系统：二手房买卖推荐系统**

> **召回阶段架构：**
>
> DNN输入层：
>
> > 1. 特征选取：
> >
> >    ①用户个人信息 - - 性别、年龄、职业、收入、所在城市、征信信息
> >
> >    ②用户行为信息 - - 各种房型的点击率、浏览时长，搜索历史，位置和配套设施偏好
> >
> >    ③item属性 -- 通过楼盘的历史房价变动信息对房屋进行投资风险评级并作为输入特征
> >
> > 2. 特征处理：
> >
> >    先将用户行为信息采用word2vec进行embedding，可以采取加权平均的方法得到用户点击向量、浏览向量及偏好向量，综合得到稠密向量，同时把用户个人信息和item属性归一化处理，由于人们往往对新房源的保值增值空间更感兴趣，这里也可以考虑example age，最后将处理后的向量拼接到一起作为DNN的输入向量。
>
> DNN隐藏层
>
> > 采用3层塔形结构，激活函数选取ReLu函数，将输入向量全连接到隐藏层，每层神经元设置由低到高1024维、512维、256维。
>
> DNN输出层
>
> > 可以考虑对输出的用户特征采用ANN的方法查找相似用户感兴趣的房源作为排序阶段样本。
>
> **排序阶段架构**
>
> > 可采用DeepFM模型或GBDT+LR模型
> >
> > 1. 特征选取：
> >
> >    ① 房源信息：房屋基本信息（楼层、面积和基本配置）、楼盘名称、地理位置、主要卖点；
> >
> >    ②房屋交易和待售信息：同地段待售房屋数、楼盘房屋换手数、楼盘及区域房价周期波动比例；
> >    （2）将上述选取的特征通过embedding层形成Dense Vector；
> >    （3）将Dense Vector同时传入到FM模型以及DNN模型中，此处的DNN模型结构采用与召回阶段相同的结构（即三层塔型结构），最终将输出进行累加得到最终推荐结果。

